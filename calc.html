<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Time & Parking Fee Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 4vw; background: #f5f5f5; }
    .container { background: white; padding: 5vw; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; margin-bottom: 20px; font-size: 1.6rem; }
    .input-group { margin-bottom: 15px; }
    label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
    input, button { width: 100%; font-size: 1rem; padding: 0.8em; border: 2px solid #ddd; border-radius: 5px; box-sizing: border-box; }
    button { background: #007bff; color: white; border: none; cursor: pointer; margin-top: 0.6em; }
    button:hover { background: #0056b3; }
    .toggle-btn { background: #28a745; }
    .toggle-btn:hover { background: #1e7e34; }
    .result { margin-top: 20px; padding: 15px; border-left: 4px solid #28a745; background: #e8f5e8; border-radius: 5px; display: none; }
    .fee { font-weight: bold; color: #007bff; }
    .advanced { display: none; margin-top: 15px; padding: 10px; border: 1px dashed #aaa; border-radius: 5px; }
    .timezone-info { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; font-size: 0.9rem; color: #6c757d; text-align: center; }
    .about-section { margin-top: 40px; padding: 20px; background: linear-gradient(135deg,#f8f9fa,#e9ecef); border-radius: 10px; border-left: 4px solid #007bff; }
    .about-title-link { color: #007bff; font-weight: bold; text-decoration: none; cursor: pointer; }
    .about-title-link:hover { text-decoration: underline; }
    .about-content { display: none; margin-top: 15px; color: #555; line-height: 1.6; font-size: 0.95rem; }
    .about-content.show { display: block; }
    .signature { display: none; margin-top: 15px; text-align: center; }
    .signature.show { display: block; }
    .signature-text { font-family: 'Brush Script MT', cursive; font-size: 1.1em; color: #495057; font-style: italic; }
    .fb-link { display: inline-block; background: #1877f2; color: white; padding: 10px 16px; border-radius: 6px; font-weight: bold; text-decoration: none; margin-top: 10px; }
    .fb-link:hover { background: #0d6efd; }
    .services-section { margin-top: 40px; padding-top: 30px; border-top: 2px solid #e9ecef; }
    .services-title { text-align: center; color: #6c757d; margin-bottom: 25px; font-size: 1.1em; font-weight: bold; }
    .services-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1rem; }
    .service-card { background: white; border: 2px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center; transition: transform .2s, box-shadow .2s; cursor: pointer; }
    .service-card:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-color: #007bff; }
    .brand-logo { width: 60px; height: 60px; margin: 0 auto 10px; }
    .brand-logo img { width: 100%; height: 100%; object-fit: contain; border-radius: 6px; }
    .service-title { font-size: 1.1rem; font-weight: bold; color: #007bff; margin-bottom: 6px; }
    .service-description { color: #6c757d; font-size: 0.85rem; margin-bottom: 10px; }
    .service-link { color: #28a745; font-weight: bold; font-size: 0.9em; text-decoration: none; }
    .service-link:hover { text-decoration: underline; }
    @media (max-width: 480px) {
      body { padding: 10px; }
      .container { padding: 1rem; }
      h1 { font-size: 1.3rem; }
      input, button { font-size: 0.9rem; padding: 0.6em; }
      .service-title { font-size: 1rem; }
      .service-description { font-size: 0.8rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚è∞ Time & Parking Fee Calculator</h1>
    <div class="input-group"><label for="startDate">Enter Date:</label><input type="date" id="startDate" required></div>
    <div class="input-group"><label for="startTime">Enter Starting Time:</label><input type="time" id="startTime" required></div>
    <div class="timezone-info" id="timezoneInfo">Using your local timezone</div>
    <button id="calculateBtn">Calculate</button>
    <button id="resetBtn" style="background:#6c757d;">Reset</button>
    <button class="toggle-btn" id="toggleAdvanced">Show Fee Options</button>
    <div class="advanced" id="advancedOptions">
      <div class="input-group"><label for="firstHours">First X hours:</label><input type="number" id="firstHours" min="1" value="3"></div>
      <div class="input-group"><label for="firstPrice">Price for first X hours:</label><input type="number" id="firstPrice" min="0" value="50"></div>
      <div class="input-group"><label for="succeedingHours">Succeeding block hours:</label><input type="number" id="succeedingHours" min="1" value="1"></div>
      <div class="input-group"><label for="succeedingPrice">Price per succeeding block:</label><input type="number" id="succeedingPrice" min="0" value="20"></div>
    </div>
    <div class="result" id="result">
      <h3>Results</h3>
      <p><strong>Start Date:</strong> <span id="displayDate"></span></p>
      <p><strong>Start Time:</strong> <span id="displayStart"></span></p>
      <p><strong>Current Time:</strong> <span id="displayNow"></span></p>
      <p><strong>Elapsed Time:</strong> <span id="elapsed"></span></p>
      <p class="fee" id="feeRow" style="display:none;"><strong>Total Fee:</strong> ‚Ç±<span id="fee"></span></p>
    </div>
    <div class="about-section">
      <a href="#" class="about-title-link" onclick="toggleAbout(event)">Why I made this calculator</a>
      <div class="about-content" id="aboutContent">
        <p>I once got overcharged at Festival Mall when a parking attendant "miscalculated" my stay...</p>
        <p>If you've had a similar experience, I'd appreciate your feedback.</p>
        <a href="https://m.me/melissa.magpale.oostendorp" target="_blank" class="fb-link">üí¨ Message me on Messenger</a>
      </div>
      <div class="signature" id="signature"><span class="signature-text">Melissa Oostendorp</span></div>
    </div>
    <div class="services-section">
      <div class="services-title">Explore Our Real Estate Services</div>
      <div class="services-container">
        <div class="service-card" onclick="window.open('http://bfhomes.ph/listings/PARKLANE-PER/','_blank')"><div class="brand-logo"><img src="./icon_property_recon.jpg" alt="bfhomes.ph Logo"></div><div class="service-title">House for Sale ‚Äî BF Homes</div><div class="service-description">Featured property in Parklane, BF Homes Para√±aque.</div></div>
        <div class="service-card" onclick="window.open('https://appraise.ph','_blank')"><div class="brand-logo"><img src="https://appraise.ph/images/logo100.jpg" alt="Appraise.ph"></div><div class="service-title">Appraise.ph</div><div class="service-description">Professional property appraisal services.</div></div>
        <div class="service-card" onclick="window.open('https://easton.ph','_blank')"><div class="brand-logo"><img src="https://easton.ph/logos_eastonrecon.png" alt="Easton.ph"></div><div class="service-title">Easton.ph</div><div class="service-description">Your trusted real estate partner.</div></div>
        <div class="service-card" onclick="window.open('https://titles.ph','_blank')"><div class="brand-logo"><img src="https://titles.ph/logo-titlesph.jpg" alt="Titles.ph"></div><div class="service-title">Titles.ph</div><div class="service-description">Simplify property title processes.</div></div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Set current local date and display timezone info
      const now = new Date();
      const year = now.getFullYear();
      const month = (now.getMonth() + 1).toString().padStart(2, '0');
      const day = now.getDate().toString().padStart(2, '0');
      document.getElementById('startDate').value = `${year}-${month}-${day}`;
      
      // Display timezone information
      const timezoneName = Intl.DateTimeFormat().resolvedOptions().timeZone;
      const timezoneOffset = -now.getTimezoneOffset() / 60;
      const offsetSign = timezoneOffset >= 0 ? '+' : '';
      document.getElementById('timezoneInfo').textContent = 
        `Using your local timezone: ${timezoneName} (UTC${offsetSign}${timezoneOffset})`;
    });

    document.getElementById('calculateBtn').onclick = function() {
      const startDate = document.getElementById('startDate').value;
      const startTime = document.getElementById('startTime').value;
      
      if (!startDate || !startTime) { 
        alert("Please enter both date and time"); 
        return; 
      }

      // Create start datetime using local timezone
      const startDateTime = new Date(`${startDate}T${startTime}:00`);
      const now = new Date();
      
      // Calculate time difference in milliseconds
      let timeDiff = now.getTime() - startDateTime.getTime();
      
      // Handle case where start time is in the future (same day)
      if (timeDiff < 0) {
        alert("Start time cannot be in the future!");
        return;
      }
      
      // Convert to minutes and calculate hours/minutes
      const totalMinutes = Math.floor(timeDiff / (1000 * 60));
      const hours = Math.floor(totalMinutes / 60);
      const minutes = totalMinutes % 60;
      
      // Update display with local time formatting
      document.getElementById('displayDate').textContent = startDateTime.toLocaleDateString();
      document.getElementById('displayStart').textContent = formatTimeLocal(startDateTime);
      document.getElementById('displayNow').textContent = formatTimeLocal(now);
      document.getElementById('elapsed').textContent = `${hours}h ${minutes}m`;
      
      // Calculate fee if advanced options are shown
      const advancedOptions = document.getElementById('advancedOptions');
      if (advancedOptions.style.display === 'block') {
        const firstHours = parseInt(document.getElementById('firstHours').value) || 3;
        const firstPrice = parseFloat(document.getElementById('firstPrice').value) || 50;
        const succeedingHours = parseInt(document.getElementById('succeedingHours').value) || 1;
        const succeedingPrice = parseFloat(document.getElementById('succeedingPrice').value) || 20;
        
        let totalFee = firstPrice;
        
        // Calculate additional fee if time exceeds first block
        if (totalMinutes > firstHours * 60) {
          const extraMinutes = totalMinutes - (firstHours * 60);
          const additionalBlocks = Math.ceil(extraMinutes / (succeedingHours * 60));
          totalFee += additionalBlocks * succeedingPrice;
        }
        
        document.getElementById('fee').textContent = totalFee.toFixed(2);
        document.getElementById('feeRow').style.display = 'block';
      } else {
        document.getElementById('feeRow').style.display = 'none';
      }
      
      document.getElementById('result').style.display = 'block';
    };

    document.getElementById('resetBtn').onclick = function() {
      document.getElementById('startTime').value = "";
      document.getElementById('result').style.display = 'none';
    };

    document.getElementById('toggleAdvanced').onclick = function() {
      const advancedOptions = document.getElementById('advancedOptions');
      const isVisible = advancedOptions.style.display === 'block';
      advancedOptions.style.display = isVisible ? 'none' : 'block';
      this.textContent = isVisible ? "Show Fee Options" : "Hide Fee Options";
    };

    function toggleAbout(e) {
      e.preventDefault();
      document.getElementById('aboutContent').classList.toggle('show');
      document.getElementById('signature').classList.toggle('show');
    }

    function formatTimeLocal(date) {
      return date.toLocaleTimeString([], {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }
  </script>
</body>
</html>
